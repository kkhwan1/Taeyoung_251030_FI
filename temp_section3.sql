INSERT INTO item_price_history (item_id, unit_price, price_month, created_at)
SELECT 
  i.item_id,
  ph.unit_price,
  CASE 
    WHEN ph.price_date = '4?붽린以' THEN DATE '2025-04-01'
    ELSE DATE_TRUNC('month', CURRENT_DATE)::date
  END as price_month,
  NOW() as created_at
FROM (
  VALUES
    ('50010562C', '?쒖쁺湲덉냽', NULL, 785),
    ('69174-DO000', '?쒖쁺湲덉냽', NULL, 1203),
    ('69184-DO000', '?쒖쁺湲덉냽', NULL, 1203),
    ('69158-DO000', '?쒖쁺湲덉냽', NULL, 451),
    ('69168-DO000', '?쒖쁺湲덉냽', NULL, 450),
    ('69118-DO000', '?쒖쁺湲덉냽', NULL, 158),
    ('50011721C', '李쎄꼍?먯뒪?뚰겕', NULL, 2169),
    ('50007278B', '李쎄꼍?먯뒪?뚰겕', NULL, 2631),
    ('50010755C', '李쎄꼍?먯뒪?뚰겕', NULL, 2644),
    ('50012110B', '李쎄꼍?먯뒪?뚰겕', NULL, 1707),
    ('651M7-L2000', '?낆??뚰겕', NULL, 298.6),
    ('65158-L8000', '?낆??뚰겕', NULL, 561),
    ('65168-L8000', '?낆??뚰겕', NULL, 561),
    ('651E3-L8000', '?낆??뚰겕', NULL, 391.68),
    ('651F3-L8000', '?낆??뚰겕', NULL, 391.68),
    ('651E4-L8000', '?낆??뚰겕', NULL, 279),
    ('651F4-L8000', '?낆??뚰겕', NULL, 279),
    ('65278-L8000', '?낆??뚰겕', NULL, 232),
    ('65116-L3400', '?낆??뚰겕', NULL, 935),
    ('65126-L3400', '?낆??뚰겕', NULL, 931),
    ('65136-L8000', '?낆??뚰겕', NULL, 205),
    ('65136-L8400', '?낆??뚰겕', NULL, 335),
    ('65158-L8000/', '?낆??뚰겕', NULL, 561),
    ('65168-L8000/', '?낆??뚰겕', NULL, 561),
    ('651E4-L8000/', '?낆??뚰겕', NULL, 279),
    ('651F4-L8000/', '?낆??뚰겕', NULL, 279),
    ('65278-L8000/', '?낆??뚰겕', NULL, 232),
    ('65116-L3400/', '?낆??뚰겕', NULL, 935),
    ('65126-L3400/', '?낆??뚰겕', NULL, 931),
    ('651M7-L8400', '?낆??뚰겕', NULL, 369.9),
    ('50010988', '?먯씠?ㅼ뿉??, NULL, 587),
    ('50010989', '?먯씠?ㅼ뿉??, NULL, 587),
    ('50010990', '?먯씠?ㅼ뿉??, NULL, 612),
    ('50010991', '?먯씠?ㅼ뿉??, NULL, 612),
    ('50008630', '?먯씠?ㅼ뿉??, NULL, 576),
    ('50008457', '?먯씠?ㅼ뿉??, NULL, 440),
    ('50008458', '?먯씠?ㅼ뿉??, NULL, 440),
    ('50008175', '?먯씠?ㅼ뿉??, NULL, 965),
    ('50008009', '?먯씠?ㅼ뿉??, NULL, 592),
    ('50008904', '?먯씠?ㅼ뿉??, NULL, 1491),
    ('50011623A', '?먯씠?ㅼ뿉??, NULL, 668),
    ('50011624A', '?먯씠?ㅼ뿉??, NULL, 668),
    ('50009770', '?먯씠?ㅼ뿉??, NULL, 131),
    ('50009772', '?먯씠?ㅼ뿉??, NULL, 131),
    ('50009975B', '?먯씠?ㅼ뿉??, NULL, 130),
    ('50009977B', '?먯씠?ㅼ뿉??, NULL, 130),
    ('50009745', '?먯씠?ㅼ뿉??, NULL, 57),
    ('50009877', '?먯씠?ㅼ뿉??, NULL, 40),
    ('50009878', '?먯씠?ㅼ뿉??, NULL, 40),
    ('50010027', '?먯씠?ㅼ뿉??, NULL, 65),
    ('50010086', '?먯씠?ㅼ뿉??, NULL, 39),
    ('50011944C', '?먯씠?ㅼ뿉??, NULL, 204),
    ('50011955C', '?먯씠?ㅼ뿉??, NULL, 204),
    ('50011939B', '?먯씠?ㅼ뿉??, NULL, 508),
    ('50011941B', '?먯씠?ㅼ뿉??, NULL, 508),
    ('50011957A', '?먯씠?ㅼ뿉??, NULL, 576),
    ('50011937C', '?먯씠?ㅼ뿉??, NULL, 137),
    ('50011938C', '?먯씠?ㅼ뿉??, NULL, 137),
    ('50010992', '?먯씠?ㅼ뿉??, NULL, 398),
    ('50010993', '?먯씠?ㅼ뿉??, NULL, 398),
    ('50010567', '?먯씠?ㅼ뿉??, NULL, 41),
    ('50010569', '?먯씠?ㅼ뿉??, NULL, 41),
    ('50011800', '?먯씠?ㅼ뿉??, NULL, 44),
    ('50011801', '?먯씠?ㅼ뿉??, NULL, 44),
    ('50000018C', '?먯씠?ㅼ뿉??, NULL, 298),
    ('69116-DO000', '?먯씠?ㅼ뿉??, NULL, 529),
    ('81836-R0500', '?먯씠?ㅼ뿉??, NULL, 462.51000000000005),
    ('81846-R0500', '?먯씠?ㅼ뿉??, NULL, 462.51000000000005),
    ('81836-R0600', '?먯씠?ㅼ뿉??, NULL, 575.4200000000001),
    ('81846-R0600', '?먯씠?ㅼ뿉??, NULL, 575.4200000000001),
    ('50014454B', '?먯씠?ㅼ뿉??, NULL, 118.4),
    ('50032843A', '?먯씠?ㅼ뿉??, NULL, 218),
    ('50032844A', '?먯씠?ㅼ뿉??, NULL, 218),
    ('50011385', '?좎꽦?곗뾽', NULL, 2680),
    ('50011384', '?좎꽦?곗뾽', NULL, 773),
    ('50011106C', '愿묒꽦?곗뾽', NULL, 177),
    ('50009766A', '?쒖씠?먯뒪?뚰겕', NULL, 513),
    ('50009768A', '?쒖씠?먯뒪?뚰겕', NULL, 513),
    ('50009971C', '?쒖씠?먯뒪?뚰겕', NULL, 508),
    ('50009973C', '?쒖씠?먯뒪?뚰겕', NULL, 508),
    ('69156-DO000', '?쒖씠?먯뒪?뚰겕', NULL, 349),
    ('69166-DO000', '?쒖씠?먯뒪?뚰겕', NULL, 349),
    ('69172-DO000', '?쒖씠?먯뒪?뚰겕', NULL, 266),
    ('69182-DO000', '?쒖씠?먯뒪?뚰겕', NULL, 266),
    ('728A1-R0500', '?쒖씠?먯뒪?뚰겕', NULL, 518),
    ('728B1-R0500', '?쒖씠?먯뒪?뚰겕', NULL, 518),
    ('72815-R0500', '?쒖씠?먯뒪?뚰겕', NULL, 645),
    ('72816-R0500', '?쒖씠?먯뒪?뚰겕', NULL, 645),
    ('65154-L8000', '?쒖씠?먯뒪?뚰겕', NULL, 986),
    ('65164-L8000', '?쒖씠?먯뒪?뚰겕', NULL, 986),
    ('65156-L8000', '?쒖씠?먯뒪?뚰겕', NULL, 1163),
    ('65166-L8000', '?쒖씠?먯뒪?뚰겕', NULL, 1163),
    ('651M8-L8000', '?쒖씠?먯뒪?뚰겕', NULL, 113),
    ('65136-L2800', '?쒖씠?먯뒪?뚰겕', NULL, 269),
    ('651M8-L2800', '?쒖씠?먯뒪?뚰겕', NULL, 305),
    ('69116-EV000', '?쒖씠?먯뒪?뚰겕', NULL, 484),
    ('69139-EV000', '?쒖씠?먯뒪?뚰겕', NULL, 59),
    ('69156-EV000', '?쒖씠?먯뒪?뚰겕', NULL, 328),
    ('69166-EV000', '?쒖씠?먯뒪?뚰겕', NULL, 328),
    ('50011308', '愿묒꽦?곗뾽', NULL, 1200),
    ('50011833', '?쒖씠?먯뒪?뚰겕', NULL, 46),
    ('65152-L1000', '?몄썝?ш툒', NULL, 2425),
    ('65162-L1000', '?몄썝?ш툒', NULL, 2424),
    ('65152-L8000', '?몄썝?ш툒', NULL, 2439),
    ('65162-L8000', '?몄썝?ш툒', NULL, 2439),
    ('65158-L1000', '?몄썝?ш툒', NULL, 714),
    ('65168-L1000', '?몄썝?ш툒', NULL, 714),
    ('651E4-L1000', '?몄썝?ш툒', NULL, 389),
    ('651F4-L1000', '?몄썝?ш툒', NULL, 389),
    ('65176-L1000', '?몄썝?ш툒', NULL, 2323),
    ('65186-L1000', '?몄썝?ш툒', NULL, 2323),
    ('65154-L1000', '?몄썝?ш툒', NULL, 1210),
    ('65164-L1000', '?몄썝?ш툒', NULL, 1210),
    ('65156-L1000', '?몄썝?ш툒', NULL, 1106),
    ('65166-L1000', '?몄썝?ш툒', NULL, 1106),
    ('651E6-L1000', '?몄썝?ш툒', NULL, 455),
    ('651F6-L1000', '?몄썝?ш툒', NULL, 455),
    ('65282-L3400', '?몄썝?ш툒', NULL, 380),
    ('65292-L3400', '?몄썝?ш툒', NULL, 380),
    ('652E6-L3400', '?몄썝?ш툒', NULL, 375),
    ('652F6-L3400', '?몄썝?ш툒', NULL, 375),
    ('65132-L1000', '?몄썝?ш툒', NULL, 4644),
    ('65132-L2500', '?몄썝?ш툒', NULL, 5034),
    ('65132-L3400', '?몄썝?ш툒', NULL, 5413),
    ('65132-L8000', '?몄썝?ш툒', NULL, 4946),
    ('65132-L8400', '?몄썝?ш툒', NULL, 4587),
    ('65352-L1000', '?몄썝?ш툒', NULL, 499),
    ('65362-L1000', '?몄썝?ш툒', NULL, 499),
    ('65174-L1000', '?몄썝?ш툒', NULL, 797),
    ('65184-L1000', '?몄썝?ш툒', NULL, 797),
    ('65264-F6000', '?몄썝?ш툒', NULL, 70),
    ('65294-D4000', '?몄썝?ш툒', NULL, 86),
    ('65264-D4000', '?몄썝?ш툒', NULL, 86),
    ('651E2-L5000', '?몄썝?ш툒', NULL, 351),
    ('651F2-L5000', '?몄썝?ш툒', NULL, 351),
    ('65172-L2000', '?몄썝?ш툒', NULL, 8937),
    ('65182-L2000', '?몄썝?ш툒', NULL, 8937),
    ('65172-L8000', '?몄썝?ш툒', NULL, 10915),
    ('65182-L8000', '?몄썝?ш툒', NULL, 10915),
    ('69145-AT000', '?몄썝?ш툒', NULL, 392),
    ('69162-G8000', '?몄썝?ш툒', NULL, 275),
    ('69156-DO000 (PAD)', '?몄썝?ш툒', NULL, 1403),
    ('69166-DO000 (PAD)', '?몄썝?ш툒', NULL, 1403),
    ('65996-C5000', '?몄썝?ш툒', NULL, 522),
    ('99242-06100', '?몄썝?ш툒', NULL, 16.25),
    ('援ъ“???묒갑泥?, '?몄썝?ш툒', NULL, 9700),
    ('12904-06101', '?몄썝?ш툒', NULL, 17.39),
    ('64372-1F000', '?몄썝?ш툒', NULL, 14.32),
    ('64372-1R000', '?몄썝?ш툒', NULL, 19.078),
    ('84191-A7500', '?몄썝?ш툒', NULL, 38),
    ('81763-1Y000', '?몄썝?ш툒', NULL, 179.09199999999998),
    ('81838-R0600', '?몄썝?ш툒', NULL, 320),
    ('13905-06000', '?몄썝?ш툒', NULL, 11.400000000000002),
    ('13905-08000', '?몄썝?ш툒', NULL, 20.14),
    ('19353-07250', '?몄썝?ш툒', NULL, 181.14),
    ('10216-10000', '?몄썝?ш툒', NULL, 79.5),
    ('13917-10120', '?몄썝?ш툒', NULL, 49.5),
    ('12900-06140', '?몄썝?ш툒', NULL, 16.12),
    ('12900-06180', '?몄썝?ш툒', NULL, 17.89),
    ('64372-3V000', '?몄썝?ш툒', NULL, 13.05),
    ('12922-06201', '?몄썝?ш툒', NULL, 35.56),
    ('12971-06203', '?몄썝?ш툒', NULL, 29.316),
    ('65178-L1000', '?몄썝?ш툒', NULL, 312.6),
    ('65178-L3400', '?몄썝?ш툒', NULL, 414.9),
    ('69146-AT000', '?몄썝?ш툒', NULL, 392),
    ('65412-L1000', '??곗궗湲?, NULL, 828),
    ('65422-L1000', '??곗궗湲?, NULL, 831),
    ('65916-L1000', '??곗궗湲?, NULL, 89),
    ('655N6-L1000', '??곗궗湲?, NULL, 1184),
    ('655P6-L1000', '??곗궗湲?, NULL, 1184),
    ('657N2-L1000', '??곗궗湲?, NULL, 990),
    ('657P2-L1000', '??곗궗湲?, NULL, 949),
    ('65832-L1000', '??곗궗湲?, NULL, 1587),
    ('65852-L2000', '??곗궗湲?, NULL, 3022),
    ('65554-D4000', '??곗궗湲?, NULL, 230),
    ('655N6-L8400', '??곗궗湲?, NULL, 1132),
    ('655P6-L8400', '??곗궗湲?, NULL, 1132),
    ('65916-L8400', '??곗궗湲?, NULL, 123),
    ('657A6-E2510', '?띻린?ш툒', NULL, 1064),
    ('657B6-E2510', '?띻린?ш툒', NULL, 1064),
    ('65512-A3000', '?띻린?ш툒', NULL, 4421),
    ('65512-E2510', '?띻린?ш툒', NULL, 4783),
    ('65821-1Y800', '?띻린?ш툒', NULL, 142),
    ('65837-A3000', '?띻린?ш툒', NULL, 1006),
    ('65847-A3000', '?띻린?ш툒', NULL, 857),
    ('65779-1Y010', '?띻린?ш툒', NULL, 57),
    ('65789-1Y010', '?띻린?ш툒', NULL, 57),
    ('65567-E2510', '?띻린?ш툒', NULL, 608),
    ('65598-E2510', '?띻린?ш툒', NULL, 875),
    ('65798-1Y000', '?띻린?ш툒', NULL, 421.3),
    ('64749-CV000', '?띻린?ш툒', NULL, 458.5),
    ('65523-A3500', '?띻린?ш툒', NULL, 258),
    ('50007752', '??쇱뵪?먰봽??, NULL, 14.5),
    ('50007315', '??쇱뵪?먰봽??, NULL, 32),
    ('12900-06201', '?꾩떊湲덉냽', NULL, 24),
    ('13905-05000', '?쇱쭊?ㅽ떥', NULL, 10.3),
    ('13194-08220', '?쇱쭊?ㅽ떥', NULL, 101.3),
    ('13911-08001', '?쇱쭊?ㅽ떥', NULL, 53.6),
    ('65639-3K000', '?꾩떊湲덉냽', NULL, 151.1),
    ('65512-C5000', NULL, NULL, 7040),
    ('65512-C5900', NULL, NULL, 7040),
    ('65522-L8400', NULL, NULL, 5513),
    ('65561-3E001', NULL, NULL, 12304),
    ('65630-L2000', NULL, NULL, 13716),
    ('65630-L2010', NULL, NULL, 13432),
    ('65630-L2020', NULL, NULL, 12981),
    ('65630-L2800', NULL, NULL, 11733),
    ('65630-L5000', NULL, NULL, 12388),
    ('65630-L5010', NULL, NULL, 12132),
    ('65630-L8400', NULL, NULL, 13372),
    ('65852-L3000', NULL, NULL, 3050),
    ('71131-2F510', NULL, NULL, 30638),
    ('71141-2F510', NULL, NULL, 30630),
    ('71201-07000', NULL, NULL, 21775),
    ('71201-3K001', NULL, NULL, 25631),
    ('71201-3L001', NULL, NULL, 25241.05),
    ('71202-07000', NULL, NULL, 21775),
    ('71202-3K001', NULL, NULL, 25627),
    ('71202-3L001', NULL, NULL, 25387.35),
    ('71377-3R000', NULL, NULL, 7734),
    ('71412-3R000', NULL, NULL, 3877),
    ('71422-3R000', NULL, NULL, 3877),
    ('71601-2G100', NULL, NULL, 37228),
    ('71602-2G100', NULL, NULL, 35639),
    ('71603-3E000', NULL, NULL, 34077),
    ('71603-3E100', NULL, NULL, 25299.95),
    ('71604-3E000', NULL, NULL, 38175),
    ('71604-3E100', NULL, NULL, 26712.6),
    ('71611-3E000', NULL, NULL, 21473),
    ('71611-3E100', NULL, NULL, 20426),
    ('71621-3E000', NULL, NULL, 19490),
    ('71621-3E100', NULL, NULL, 21604),
    ('71653-2P000', NULL, NULL, 2438),
    ('71663-2P000', NULL, NULL, 2437),
    ('71678-2P700', NULL, NULL, 2956),
    ('71688-2P700', NULL, NULL, 2956),
    ('71731-2P700', NULL, NULL, 2117),
    ('71741-2P700', NULL, NULL, 2103),
    ('76230-2G010', NULL, NULL, 20080),
    ('76231-A7000', NULL, NULL, 1294),
    ('76240-2G010', NULL, NULL, 20022),
    ('76241-A7000', NULL, NULL, 1294),
    ('77230-2G010', NULL, NULL, 20318),
    ('77240-2G010', NULL, NULL, 20314.35)
) AS ph(item_code, supplier_name, price_date, unit_price)
INNER JOIN items i ON i.item_code = ph.item_code
WHERE NOT EXISTS (
  SELECT 1 FROM item_price_history 
  WHERE item_price_history.item_id = i.item_id 
    AND item_price_history.price_month = CASE 
      WHEN ph.price_date = '4?붽린以' THEN DATE '2025-04-01'
      ELSE DATE_TRUNC('month', CURRENT_DATE)
    END
);
