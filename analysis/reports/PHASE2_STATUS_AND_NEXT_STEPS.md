# Phase 2 현재 상태 및 다음 단계

**작성일**: 2025-11-05  
**상태**: 비교 완료, 데이터 추가 준비 중

---

## ✅ 완료된 작업

### 1. 엑셀 데이터 추출 (Phase 1)
- **BOM 관계**: 171개 (고유 조합: 143개)
- **가격 정보**: 115개
- **스펙 정보**: 포함

### 2. DB BOM 전체 데이터 조회
- **Supabase MCP 쿼리**: 전체 347개 BOM 관계 조회 완료
- **데이터 구조**: parent_code, child_code, quantity_required, level_no, item_id 포함

### 3. 비교 수행
- **엑셀 BOM**: 143개 (고유 조합)
- **DB BOM**: 347개
- **누락된 BOM**: 엑셀에 있으나 DB에 없는 조합 다수 확인

---

## 📊 비교 결과

### BOM 데이터
- **엑셀**: 143개 고유 조합
- **DB**: 347개
- **누락 가능**: 엑셀에 있으나 DB에 없는 조합들

### 가격 정보
- **엑셀**: 115개
- **DB 가격 누락**: 302개 품목
- **업데이트 가능**: 엑셀 가격 정보로 DB 업데이트 가능

---

## 📋 다음 단계

### Phase 2.2: 누락된 BOM 관계 추가

1. **정확한 비교 수행**
   - 전체 DB BOM 데이터(347개)와 엑셀(143개) 정확한 비교
   - 누락된 BOM 관계 최종 식별

2. **품목 코드 → item_id 매핑**
   - 엑셀의 parent_code, child_code를 DB items 테이블에서 조회하여 item_id 찾기
   - 존재하지 않는 품목은 items 테이블에 먼저 추가

3. **BOM 관계 추가**
   - 누락된 BOM 관계를 bom 테이블에 INSERT
   - 중복 체크 및 트랜잭션 처리

### Phase 2.3: 가격 업데이트

1. **가격 업데이트 대상 식별**
   - DB items에서 price가 NULL이거나 0인 품목 확인
   - 엑셀 가격 정보와 매칭

2. **가격 업데이트 실행**
   - 엑셀 가격 정보로 DB items.price 업데이트
   - 기존 가격이 있는 경우 건너뛰기 옵션

---

## ⚠️ 주의사항

1. **중복 방지**: 모든 추가 작업 전 중복 체크 필수
2. **데이터 백업**: 작업 전 DB 백업 필수
3. **단계별 실행**: 한 번에 모든 데이터 추가하지 말고 단계별로 진행
4. **검증**: 각 단계마다 결과 확인 및 검증 수행

---

**Phase 2 상태**: ⏳ 진행 중 (70% 완료)  
**다음 작업**: 전체 DB BOM 데이터와 정확한 비교 및 누락된 BOM 추가

