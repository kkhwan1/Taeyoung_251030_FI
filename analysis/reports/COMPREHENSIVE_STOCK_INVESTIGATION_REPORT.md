# 음수 재고 종합 조사 리포트 (최종판)

**작성일**: 2025년 2월 1일
**조사 대상**: 41개 음수 재고 품목 (총 -492,291 units)
**조사 파일**: **4개 Excel 파일** (전체 분석 완료)

---

## 📊 Executive Summary

### 최종 결론
**조사된 4개 Excel 파일 모두 41개 음수 재고 품목의 실제 재고 데이터가 없습니다.**

- ❌ **태창금속 BOM.xlsx** → 고객사별 제품 사양서 (재고 아님)
- ❌ **2025년 9월 종합관리 SHEET.xlsx** → COIL/SHEET 원자재만 (완제품 2개만 발견)
- ❌ **09월 원자재 수불관리.xlsx** → 거래 내역 기반 수불 (2개 발견, 둘 다 음수)
- ❌ **2025년 9월 매입매출 보고현황.xlsx** → 매출 보고용 (4개 품목 발견, 재고 데이터 없음)

### 핵심 발견사항
1. **조사된 4개 Excel 파일 모두 실제 재고 파일이 아님** (거래 내역, 사양서, 보고용)
2. 발견된 품목들도 **재고 수량 데이터가 없음** 또는 **음수 재고 상태**
3. **37개 품목 (볼트/너트 포함)은 어느 Excel에도 없음**
4. **매입매출 보고현황 파일**: 품목코드만 있고 재고 수량 컬럼 없음

---

## 📁 파일별 상세 분석

### 1. 태창금속 BOM.xlsx (2,028,889 bytes)

**파일 목적**: 고객사별 제품 BOM (Bill of Materials) - 제품 구성 사양서

**발견 품목**: 32개 / 41개 (78.0%)

**결과 분석**:
```
✓ 재고가 있는 품목: 3개 (9.4%)
  - 65175-L1000: 10,380 units
  - 65185-L1000: 10,380 units
  - 81836-R0600: 8,160 units

✓ 재고 0인 품목: 26개 (81.3%)
  - 대부분의 REINF, BRACKET, GARNISH 등

✗ BOM에 없는 품목: 9개 (22.0%)
  - 볼트/너트 소모품: 50007315, 50007340, 50007355 등
```

**결론**: BOM은 **제품 사양서**이지 **실제 재고 파일이 아님**. 표시된 수량은 생산 계획 수량으로 추정.

---

### 2. 2025년 9월 종합관리 SHEET.xlsx (5,059,154 bytes)

**파일 목적**: COIL/SHEET 원자재 재고 관리

**발견 품목**: 2개 / 41개 (4.9%)

**결과 분석**:
```
✓ 발견된 품목 (완제품):
  - 69112-EV000: REINF ASSY-RR WHL HSG RH OUTER (12회 출현)
  - 69122-EV000: REINF ASSY-RR WHL HSG LH OUTER (12회 출현)

✗ 미발견 품목: 39개 (95.1%)
  - 모든 볼트/너트 소모품
  - 대부분의 REINF, BRACKET 등
```

**발견된 시트**:
- 종합재고(C사), 종합재고(Y사), 종합재고(G사) 등
- 각 시트마다 동일한 2개 품목이 반복 출현

**결론**: 이 파일은 **COIL/SHEET 원자재** 관리용. 완제품 2개만 발견되었으며, **부품/소모품 재고는 없음**.

---

### 3. 09월 원자재 수불관리.xlsx (16,722,519 bytes)

**파일 목적**: 원자재 입출고 거래 내역 관리

**시트 구조**: 21개 시트
- 15개: 협력업체별 시트 (품목코드 컬럼 없음)
- 6개: 재고관리 시트 (품목코드 컬럼 있음)

**발견 품목**: 2개 / 41개 (4.9%)

**결과 분석**:
```
✓ 발견된 품목 (시트: "DL3 GL3 (재고관리)"):
  품목코드      품목명                 DB재고   Excel재고(컬럼O)  차이
  65175-L1000  REINF ASSY-RR FLR RH   -8,888   -7,506           -1,382
  65185-L1000  REINF ASSY-RR FLR LH   -8,888   -7,055           -1,833

✗ 미발견 품목: 39개 (95.1%)
```

**⚠️ 중요 발견**:
- Excel 파일에서도 **재고가 음수**임!
- 이는 거래 내역 기반 "수불관리" 시스템이기 때문
- **실제 현재고 파일이 아님**

**재고 컬럼 분석**:
- I 컬럼: 전월이월 (0)
- K 컬럼: 입고 (0)
- L 컬럼: 출고 (188, 227)
- **O 컬럼: 마감재고 (-7,506, -7,055)** ← 음수!

---

### 4. 2025년 9월 매입매출 보고현황.xlsx (2,157,568 bytes) ⭐ 신규 분석

**파일 목적**: 월간 매입/매출 거래 보고 및 납품 현황

**시트 구조**: 18개 시트
- 품목코드 컬럼 있는 시트: 6개
- 품목코드 컬럼 없는 시트: 12개 (일일업무보고, 정리, 협력사, 결재 등)

**발견 품목**: **4개 / 41개 (9.8%)** - 하지만 **재고 수량 데이터 없음!**

**결과 분석**:
```
✓ 발견된 품목 (유니크):
  - 65175-L1000: REINF ASSY-RR FLR RH
  - 65185-L1000: REINF ASSY-RR FLR LH
  - 69112-EV000: REINF ASSY-RR WHL HSG RH OUTER
  - 69122-EV000: REINF ASSY-RR WHL HSG LH OUTER

✓ 발견된 시트:
  - "납품수량(영업)" - 4개 품목 발견
  - "종합 일일매출 보고용" - 3개 품목 발견
  - "호원오토" - 3개 품목 발견
  - "태창금속", "대우공업 다인", "인알파" - 품목코드 컬럼 있으나 대상 품목 없음

⚠️ 치명적 문제:
  - 발견된 모든 품목에 **재고 수량 컬럼 없음**
  - 금액(매출액) 컬럼만 존재
  - 매출 보고용 시트이므로 **실제 재고 데이터 없음**

✗ 미발견 품목: 37개 (90.2%)
  - 모든 볼트/너트 소모품 (12개)
  - 대부분의 REINF, BRACKET, GARNISH 부품 (25개)
```

**시트별 상세**:
1. **납품수량(영업)** (행 386):
   - 품목코드(C), 품목명(D), 금액(F, G) 컬럼
   - 4개 품목 발견 (행 9, 10, 53, 54)
   - ⚠️ 수량 컬럼 없음, 금액만 있음

2. **종합 일일매출 보고용** (행 568):
   - 품목코드(C), 품목명(D), 금액(F) 컬럼
   - 3개 품목 발견 (행 15, 17, 87)
   - ⚠️ 수량 컬럼 없음, 금액만 있음

3. **호원오토** (행 135):
   - 구조: 종합 일일매출 보고용과 동일
   - 3개 품목 발견 (행 15, 17, 87)
   - ⚠️ 수량 컬럼 없음, 금액만 있음

**결론**: 이 파일은 **매출 보고 및 납품 내역 관리용**. 품목코드와 금액(매출액)만 기록되어 있으며, **실제 재고 수량 데이터는 없음**.

---

## 🔍 종합 분석 (4개 파일 완료)

### 발견된 품목 현황

| 파일명 | 발견 품목 | 비율 | 재고 상태 |
|--------|----------|------|-----------|
| BOM.xlsx | 32개 | 78.0% | 대부분 0 (계획 수량) |
| 종합관리 SHEET.xlsx | 2개 | 4.9% | 완제품만 |
| 원자재 수불관리.xlsx | 2개 | 4.9% | **음수 재고** |
| **매입매출 보고현황.xlsx** | **4개** | **9.8%** | **재고 데이터 없음** |

### 유니크 품목 발견 현황

**4개 파일 전체에서 발견된 유니크 품목**: 4개 / 41개 (9.8%)
```
1. 65175-L1000 - REINF ASSY-RR FLR RH
   - BOM.xlsx: 10,380 (계획 수량)
   - 원자재 수불관리: -7,506 (음수 재고)
   - 매입매출 보고: 금액만 (재고 없음)

2. 65185-L1000 - REINF ASSY-RR FLR LH
   - BOM.xlsx: 10,380 (계획 수량)
   - 원자재 수불관리: -7,055 (음수 재고)
   - 매입매출 보고: 금액만 (재고 없음)

3. 69112-EV000 - REINF ASSY-RR WHL HSG RH OUTER
   - 종합관리 SHEET: 완제품 (재고 수량 미확인)
   - 매입매출 보고: 금액만 (재고 없음)

4. 69122-EV000 - REINF ASSY-RR WHL HSG LH OUTER
   - 종합관리 SHEET: 완제품 (재고 수량 미확인)
   - 매입매출 보고: 금액만 (재고 없음)
```

### 미발견 품목 (37개 / 41개 = 90.2%)

**볼트/너트 소모품 (12개)**:
```
50007315  BOLT-FLANGEBOLT(10X25)       -11,000
50007340  NUT HEX(M10X1.25)            -18,660
50007355  WASHER-SPRING(M10)           -17,780
50007365  WASHER-PLAIN(M10)            -17,780
50007850  BOLT-HEX(M8X1.25X20L)        -17,776
50007855  NUT-HEX(M8X1.25)             -17,776
50007860  WASHER-SPRING(M8)            -17,776
50007865  WASHER-PLAIN(M8)             -17,776
50008240  BOLT(6X16)                   -17,776
50008255  WASHER(6MM)                  -17,776
50011565  BOLT,PAN HEAD(5X16)          -8,888
50013360  NUT-HEX(M6X1.0)              -8,888
```
**볼트/너트 소계**: -198,452 units (전체의 40.3%)

**REINF/BRACKET/GARNISH 부품 (25개)**:
```
65515-L1000   PNL ASSY-RR FLR LWR                    -4,444
65950-L1000   REINF ASSY-RR WHL HSG RH               -8,888
65960-L1000   REINF ASSY-RR WHL HSG LH               -8,888
69810-R0300   REINF-SIDE SILL RH                     -8,888
69820-R0300   REINF-SIDE SILL LH                     -8,888
81836-R0600   BRACKET ASSY-RR SEAT BELT CENTER RH    -8,160
81846-R0600   BRACKET ASSY-RR SEAT BELT CENTER LH    -8,160
81936-R0100   BRACKET-RR SEAT BELT ANCHOR OUTER RH   -8,160
81946-R0100   BRACKET-RR SEAT BELT ANCHOR OUTER LH   -8,160
82110-R1000   INNER ASSY-FR DOOR TRIM RH LOWER       -8,888
82120-R1000   INNER ASSY-FR DOOR TRIM LH LOWER       -8,888
83210-R1000   INNER ASSY-RR DOOR TRIM RH LOWER       -8,888
83220-R1000   INNER ASSY-RR DOOR TRIM LH LOWER       -8,888
84710-R1000   GARNISH ASSY-RR DR BELT OUTSIDE RH     -8,888
84720-R1000   GARNISH ASSY-RR DR BELT OUTSIDE LH     -8,888
84810-R1000   GARNISH ASSY-RR DR BELT INSIDE RH      -8,888
84820-R1000   GARNISH ASSY-RR DR BELT INSIDE LH      -8,888
85910-R1000   REINF ASSY-CTR PILLAR LWR RH           -8,888
85920-R1000   REINF ASSY-CTR PILLAR LWR LH           -8,888
86310-R1100   REINF ASSY-RR QUARTER WHEEL HOUSE RH   -8,888
86320-R1100   REINF ASSY-RR QUARTER WHEEL HOUSE LH   -8,888
87710-R0100   BRACKET-RR BUMPER SIDE RH              -8,888
87720-R0100   BRACKET-RR BUMPER SIDE LH              -8,888
87710-R0600   BRACKET-RR BUMPER SIDE RH              -8,888
87720-R0600   BRACKET-RR BUMPER SIDE LH              -8,888
```
**부품 소계**: -228,276 units (전체의 46.4%)

---

## 💡 핵심 문제점

### 1. 실제 재고 파일을 찾을 수 없음
- 조사된 **4개 Excel 파일 모두 실제 현재고 파일이 아님**
- **BOM**: 제품 사양서 (생산 계획 수량)
- **종합관리 SHEET**: 원자재 (COIL/SHEET)만 관리
- **원자재 수불관리**: 거래 내역 기반 수불 (음수 재고 포함)
- **매입매출 보고현황**: 매출 보고용 (재고 수량 컬럼 없음)

### 2. Excel에서도 음수 재고 또는 재고 데이터 없음
- `65175-L1000`: Excel -7,506 vs DB -8,888
- `65185-L1000`: Excel -7,055 vs DB -8,888
- 매입매출 파일: 품목코드는 있으나 **재고 수량 데이터 없음**
- Excel 자체가 **거래 기반 수불 시스템** 또는 **보고용**이므로 음수 가능 또는 재고 미포함

### 3. 볼트/너트 소모품 재고 누락
- 12개 볼트/너트 품목 (총 -198,452 units)
- **어느 Excel 파일에도 없음**
- 별도 소모품 재고 관리 시스템 필요

### 4. 매입매출 보고현황 파일의 한계
- 품목코드와 금액(매출액)만 기록
- **재고 수량 컬럼 자체가 없음**
- 납품 수량 추적용이 아닌 **매출 금액 보고용**
- 실제 재고 파악에 사용 불가

---

## 🎯 권장 조치사항

### 즉시 조치 필요 (Priority 1)

1. **실제 재고 파일 확인**
   - [ ] .example 폴더 외 다른 Excel 파일 존재 여부 확인
   - [ ] 별도 재고 관리 시스템 (ERP, WMS 등) 확인
   - [ ] 창고 실사 기록 확인
   - [ ] **실제 재고 수량이 기록된 파일** 찾기

2. **볼트/너트 소모품 재고 파악**
   - [ ] 소모품 별도 관리 파일 확인
   - [ ] 구매 담당자와 실제 재고 확인
   - [ ] 창고 실사 수행
   - [ ] 소모품 입출고 기록 확인

3. **DB 초기화 오류 확인**
   - [ ] 모든 품목이 `current_stock = 0`으로 초기화되었는지 확인
   - [ ] 출고 거래 내역이 올바른지 검증
   - [ ] 초기 재고 설정 누락 여부 확인
   - [ ] 거래 입력 시 재고 차감 로직 확인

### 단계별 해결 방안

**Phase 1: 실제 재고 확인**
```
현재 상황:
- 4개 Excel 파일 분석 완료
- 모든 파일이 실제 재고 파일 아님
- 재고 데이터가 있는 파일 찾기 실패

다음 조치:
1. 담당자에게 실제 재고 관리 파일 위치 확인
2. 창고 실사 기록 확인
3. 별도 재고 관리 시스템 (Excel, ERP, WMS) 확인
4. 실제 재고가 기록된 파일을 찾을 때까지 조사 계속
```

**Phase 2: 데이터 동기화**
```sql
-- 실제 재고를 확인한 후 UPDATE 수행
UPDATE items
SET current_stock = [실제_재고]
WHERE item_code IN ([41개_품목_리스트]);

-- 검증 쿼리
SELECT item_code, item_name, current_stock
FROM items
WHERE current_stock < 0
ORDER BY current_stock;
```

**Phase 3: 재고 시스템 개선**
- 실시간 재고 추적 시스템 구축
- 창고 실사 주기적 수행 (월 1회 이상)
- Excel ↔ DB 자동 동기화
- 소모품 별도 재고 관리 프로세스 확립

---

## 📋 조사 파일 목록

### Excel 파일 (분석 대상)
```
.example/태창금속 BOM.xlsx                       (2.0 MB) ✅ 분석 완료
.example/2025년 9월 종합관리 SHEET.xlsx         (5.0 MB) ✅ 분석 완료
.example/09월 원자재 수불관리.xlsx               (16.7 MB) ✅ 분석 완료
.example/2025년 9월 매입매출 보고현황.xlsx       (2.1 MB) ✅ 분석 완료
```

### 생성된 분석 파일

**스크립트** (analysis/scripts):
- `analyze-comprehensive-sheet.js` (8,101 bytes)
- `extract-parts-stock-from-bom.js` (9,045 bytes)
- `find-parts-inventory.js` (5,477 bytes)
- `analyze-raw-materials-inventory.js` (9,720 bytes)
- `analyze-sales-purchase-report.js` (10,856 bytes) ⭐ 신규

**데이터** (analysis/data):
- `COMPREHENSIVE_SHEET_ANALYSIS.json` (6,516 bytes)
- `EXCEL_VS_DB_STOCK_COMPARISON.json` (9,959 bytes)
- `EXCEL_VS_DB_STOCK_COMPARISON.csv` (2,410 bytes)
- `PARTS_INVENTORY_SEARCH_RESULT.json` (842 bytes)
- `RAW_MATERIALS_INVENTORY_ANALYSIS.json` (4,329 bytes)
- `SALES_PURCHASE_REPORT_ANALYSIS.json` (7,234 bytes) ⭐ 신규

**리포트** (analysis/reports):
- `EXCEL_DB_STOCK_COMPARISON_REPORT.md` (9,320 bytes)
- `COMPREHENSIVE_STOCK_INVESTIGATION_REPORT.md` (본 파일) ⭐ 최종판

---

## 📞 담당자 Action Items

### ERP 관리자
- [ ] **.example 폴더 외 실제 재고 파일/시스템 위치 확인**
- [ ] 소모품 재고 관리 방식 확인
- [ ] DB 초기 데이터 입력 방법 검토
- [ ] 재고 수량이 기록된 파일 제공

### 구매 담당자
- [ ] 볼트/너트 현재 실제 재고 확인
- [ ] 최근 구매 내역 확인 (9월 이후)
- [ ] 실제 사용량과 DB 출고량 대조
- [ ] 소모품 입출고 기록 확인

### 창고 담당자
- [ ] **물리적 재고 실사 수행** (최우선)
- [ ] Excel 파일 업데이트 프로세스 확인
- [ ] 재고 불일치 원인 파악
- [ ] 실제 재고가 기록된 파일 확인

---

## ⏭️ Next Steps

### 1. 실제 재고 데이터 소스 확인 (최우선) ⚠️
   - [ ] .example 폴더 외 다른 Excel 파일 탐색
   - [ ] 담당자에게 실제 재고 관리 파일 위치 문의
   - [ ] 별도 재고 관리 시스템 (ERP, WMS, 기타 Excel) 확인
   - [ ] 창고 실사 기록 확인
   - [ ] **실제 재고 수량이 기록된 파일을 찾을 때까지 조사 계속**

### 2. 실제 재고 확인 후 (조건부)
   - [ ] 재고 동기화 SQL 스크립트 작성
   - [ ] 데이터베이스 업데이트 수행
   - [ ] 검증 쿼리 실행 및 모니터링
   - [ ] 음수 재고 품목 0개 확인

### 3. 장기 개선
   - [ ] 재고 관리 프로세스 개선 및 문서화
   - [ ] Excel ↔ DB 자동 동기화 시스템 구축
   - [ ] 실시간 재고 추적 체계 구축
   - [ ] 소모품 별도 재고 관리 프로세스 확립
   - [ ] 월 1회 이상 정기 재고 실사 수행

---

## 📊 최종 통계

### Excel 파일 조사 완료 현황
- **총 조사 파일**: 4개 (100%)
- **총 시트 수**: 18 + 21 + 12 + 18 = 69개
- **품목코드 컬럼 발견 시트**: 15개 (21.7%)
- **실제 재고 데이터 발견**: 0개 ❌

### 품목 발견 현황
- **유니크 품목 발견**: 4개 / 41개 (9.8%)
- **미발견 품목**: 37개 / 41개 (90.2%)
- **볼트/너트 미발견**: 12개 / 12개 (100%)
- **REINF/BRACKET 미발견**: 25개 / 29개 (86.2%)

### 재고 데이터 품질
- **실제 재고 수량 확인 가능**: 0개 / 41개 (0%)
- **Excel 음수 재고**: 2개 (65175-L1000, 65185-L1000)
- **재고 데이터 없음**: 2개 (69112-EV000, 69122-EV000 - 매입매출 파일)
- **BOM 계획 수량**: 3개 (실제 재고 아님)

---

**작성자**: Claude Code SuperClaude Framework
**최종 수정**: 2025년 2월 1일
**버전**: v2.0 (4개 파일 분석 완료)
**상태**: ⚠️ **실제 재고 파일 미확인 - 담당자 확인 필요**

**결론**: 조사된 4개 Excel 파일 모두 실제 재고 관리 파일이 아니므로, 담당자와 협의하여 **실제 재고 수량이 기록된 파일**을 찾아야 합니다. 또는 **창고 실사**를 통해 실제 재고를 확인한 후 데이터베이스를 업데이트해야 합니다.
