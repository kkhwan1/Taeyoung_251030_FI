# 코일 추적 기능 설명

## 📋 코일 추적이란?

코일 추적(Coil Tracking)은 **코일 원자재가 어떤 공정을 거쳐 어떤 제품으로 변환되었는지 추적하는 기능**입니다.

### 핵심 개념

1. **코일(원자재)** → **공정 처리** → **반제품/제품**
2. 각 공정 단계별 이력 추적
3. 수율 계산 및 재고 자동 이동

## 🔄 코일 추적 프로세스

### 예시 시나리오

```
코일 원자재 (1000kg)
    ↓ [블랭킹 공정]
판재 반제품 (950kg, 수율 95%)
    ↓ [전단 공정]
절단된 부품 (900kg, 수율 94.7%)
    ↓ [절곡 공정]
성형된 부품 (850kg, 수율 94.4%)
    ↓ [용접 공정]
완제품 (800kg, 수율 94.1%)
```

## 📊 코일 추적 데이터 구조

### 테이블: `coil_process_history`

| 필드 | 설명 | 예시 |
|------|------|------|
| `process_id` | 공정 이력 ID | 1, 2, 3... |
| `source_item_id` | 투입 코일 품목 ID | 원자재 ID |
| `target_item_id` | 산출 품목 ID | 반제품/제품 ID |
| `process_type` | 공정 유형 | 블랭킹, 전단, 절곡, 용접 |
| `input_quantity` | 투입 수량 | 1000 |
| `output_quantity` | 산출 수량 | 950 |
| `yield_rate` | 수율 (%) | 95.0 (자동 계산) |
| `process_date` | 공정 일자 | 2025-01-21 |
| `status` | 상태 | PENDING, IN_PROGRESS, COMPLETED, CANCELLED |

## 🎯 코일 추적 기능의 목적

### 1. 추적성(Traceability)
- 코일 원자재가 어떤 제품으로 변환되었는지 추적
- 제품의 원료 출처 확인
- 품질 이슈 발생 시 원인 추적

### 2. 수율 관리
- 각 공정 단계별 수율 자동 계산
- 수율 저하 원인 분석
- 공정 효율성 개선

### 3. 재고 관리
- 공정 완료 시 재고 자동 이동
- 투입 재료 자동 차감
- 산출 제품 자동 입고

## 📱 사용 방법

### 1. 코일 추적 모드 접근
- 공정 관리 페이지 → "코일 추적" 버튼 클릭
- 또는 URL: `/process?source=coil_tracking`

### 2. 코일 추적 데이터 확인
- 상태별 탭으로 필터링 (대기, 진행중, 완료, 전체)
- 공정 유형별 필터링 (블랭킹, 전단, 절곡, 용접)
- 날짜 범위 필터링

### 3. 코일 추적 정보
- **공정 유형**: 블랭킹, 전단, 절곡, 용접
- **투입 코일**: 원자재 정보
- **산출 품목**: 반제품/제품 정보
- **수율**: 자동 계산된 수율 표시
- **상태**: 공정 진행 상태

## 🔍 코일 추적 vs 공정 작업

### 공통점
- 공정 이력 관리
- 재고 자동 이동
- 수율 계산

### 차이점

| 항목 | 공정 작업 | 코일 추적 |
|------|----------|----------|
| **대상** | 모든 공정 (Blanking, Press, Assembly) | 코일 관련 공정만 |
| **공정 유형** | BLANKING, PRESS, ASSEMBLY | 블랭킹, 전단, 절곡, 용접 |
| **용도** | 일반 제조 공정 관리 | 코일 원자재 추적 전용 |
| **데이터 소스** | `process_operations` | `coil_process_history` |
| **작업 버튼** | 시작/완료 버튼 있음 | 조회 전용 (버튼 없음) |

## 💡 실제 사용 예시

### 시나리오: 코일에서 완제품까지 추적

1. **블랭킹 공정**
   - 코일 원자재 1000kg → 판재 반제품 950kg
   - 수율: 95%
   - 상태: COMPLETED

2. **전단 공정**
   - 판재 반제품 950kg → 절단 부품 900kg
   - 수율: 94.7%
   - 상태: COMPLETED

3. **절곡 공정**
   - 절단 부품 900kg → 성형 부품 850kg
   - 수율: 94.4%
   - 상태: IN_PROGRESS

4. **용접 공정**
   - 성형 부품 850kg → 완제품 800kg
   - 수율: 94.1%
   - 상태: PENDING

## 📊 생성된 테스트 데이터

현재 데이터베이스에 다음 테스트 데이터가 생성되었습니다:

- **블랭킹 공정**: 1건 (COMPLETED)
- **전단 공정**: 1건 (상태 다양)
- **절곡 공정**: 1건 (상태 다양)
- **용접 공정**: 1건 (상태 다양)

각 공정은 서로 다른 날짜와 상태로 생성되어 필터링 테스트가 가능합니다.

## ✅ 코일 추적 기능 확인 방법

1. **공정 관리 페이지** 접속
2. **"코일 추적" 버튼** 클릭
3. **상태별 탭** 클릭하여 필터링 확인
4. **공정 유형** 확인 (블랭킹, 전단, 절곡, 용접)
5. **수율 정보** 확인
6. **투입/산출 품목** 정보 확인

## 🔗 관련 기능

- **추적성 조회**: `/traceability` - 특정 품목의 전체 추적 이력 조회
- **공정 작업**: `/process` - 일반 공정 작업 관리
- **재고 관리**: 공정 완료 시 자동 재고 이동

