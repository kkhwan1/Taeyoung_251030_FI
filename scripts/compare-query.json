{"query":"\n-- Full comparison of Excel BOM 최신단가 vs Database\nWITH excel_prices AS (\n  SELECT item_code, price, supplier\n  FROM (VALUES\n    ('50010562C', 785, '태영금속'),\n    ('69174-DO000', 1203, '태영금속'),\n    ('69184-DO000', 1203, '태영금속'),\n    ('69158-DO000', 451, '태영금속'),\n    ('69168-DO000', 450, '태영금속'),\n    ('69118-DO000', 158, '태영금속'),\n    ('50011721C', 2169, '창경에스테크'),\n    ('50007278B', 2631, '창경에스테크'),\n    ('50010755C', 2644, '창경에스테크'),\n    ('50012110B', 1707, '창경에스테크'),\n    ('651M7-L2000', 298.6, '웅지테크'),\n    ('65158-L8000', 561, '웅지테크'),\n    ('65168-L8000', 561, '웅지테크'),\n    ('651E3-L8000', 391.68, '웅지테크'),\n    ('651F3-L8000', 391.68, '웅지테크'),\n    ('651E4-L8000', 279, '웅지테크'),\n    ('651F4-L8000', 279, '웅지테크'),\n    ('65278-L8000', 232, '웅지테크'),\n    ('65116-L3400', 935, '웅지테크'),\n    ('65126-L3400', 931, '웅지테크'),\n    ('65136-L8000', 205, '웅지테크'),\n    ('65136-L8400', 335, '웅지테크'),\n    ('65158-L8000/', 561, '웅지테크'),\n    ('65168-L8000/', 561, '웅지테크'),\n    ('651E4-L8000/', 279, '웅지테크'),\n    ('651F4-L8000/', 279, '웅지테크'),\n    ('65278-L8000/', 232, '웅지테크'),\n    ('65116-L3400/', 935, '웅지테크'),\n    ('65126-L3400/', 931, '웅지테크'),\n    ('651M7-L8400', 369.9, '웅지테크'),\n    ('50010988', 587, '에이오에스'),\n    ('50010989', 587, '에이오에스'),\n    ('50010990', 612, '에이오에스'),\n    ('50010991', 612, '에이오에스'),\n    ('50008630', 576, '에이오에스'),\n    ('50008457', 440, '에이오에스'),\n    ('50008458', 440, '에이오에스'),\n    ('50008175', 965, '에이오에스'),\n    ('50008009', 592, '에이오에스'),\n    ('50008904', 1491, '에이오에스'),\n    ('50011623A', 668, '에이오에스'),\n    ('50011624A', 668, '에이오에스'),\n    ('50009770', 131, '에이오에스'),\n    ('50009772', 131, '에이오에스'),\n    ('50009975B', 130, '에이오에스'),\n    ('50009977B', 130, '에이오에스'),\n    ('50009745', 57, '에이오에스'),\n    ('50009877', 40, '에이오에스'),\n    ('50009878', 40, '에이오에스'),\n    ('50010027', 65, '에이오에스'),\n    ('50010086', 39, '에이오에스'),\n    ('50011944C', 204, '에이오에스'),\n    ('50011955C', 204, '에이오에스'),\n    ('50011939B', 508, '에이오에스'),\n    ('50011941B', 508, '에이오에스'),\n    ('50011957A', 576, '에이오에스'),\n    ('50011937C', 137, '에이오에스'),\n    ('50011938C', 137, '에이오에스'),\n    ('50010992', 398, '에이오에스'),\n    ('50010993', 398, '에이오에스'),\n    ('50010567', 41, '에이오에스'),\n    ('50010569', 41, '에이오에스'),\n    ('50011800', 44, '에이오에스'),\n    ('50011801', 44, '에이오에스'),\n    ('50000018C', 298, '에이오에스'),\n    ('69116-DO000', 529, '에이오에스'),\n    ('81836-R0500', 462.51000000000005, '에이오에스'),\n    ('81846-R0500', 462.51000000000005, '에이오에스'),\n    ('81836-R0600', 575.4200000000001, '에이오에스'),\n    ('81846-R0600', 575.4200000000001, '에이오에스'),\n    ('50014454B', 118.4, '에이오에스'),\n    ('50032843A', 218, '에이오에스'),\n    ('50032844A', 218, '에이오에스'),\n    ('50011385', 2680, '신성산업'),\n    ('50011384', 773, '신성산업'),\n    ('50011106C', 177, '광성산업'),\n    ('50009766A', 513, '제이에스테크'),\n    ('50009768A', 513, '제이에스테크'),\n    ('50009971C', 508, '제이에스테크'),\n    ('50009973C', 508, '제이에스테크'),\n    ('69156-DO000', 349, '제이에스테크'),\n    ('69166-DO000', 349, '제이에스테크'),\n    ('69172-DO000', 266, '제이에스테크'),\n    ('69182-DO000', 266, '제이에스테크'),\n    ('728A1-R0500', 518, '제이에스테크'),\n    ('728B1-R0500', 518, '제이에스테크'),\n    ('72815-R0500', 645, '제이에스테크'),\n    ('72816-R0500', 645, '제이에스테크'),\n    ('65154-L8000', 986, '제이에스테크'),\n    ('65164-L8000', 986, '제이에스테크'),\n    ('65156-L8000', 1163, '제이에스테크'),\n    ('65166-L8000', 1163, '제이에스테크'),\n    ('651M8-L8000', 113, '제이에스테크'),\n    ('65136-L2800', 269, '제이에스테크'),\n    ('651M8-L2800', 305, '제이에스테크'),\n    ('69116-EV000', 484, '제이에스테크'),\n    ('69139-EV000', 59, '제이에스테크'),\n    ('69156-EV000', 328, '제이에스테크'),\n    ('69166-EV000', 328, '제이에스테크'),\n    ('50011308', 1200, '광성산업'),\n    ('50011833', 46, '제이에스테크'),\n    ('65152-L1000', 2425, '호원사급'),\n    ('65162-L1000', 2424, '호원사급'),\n    ('65152-L8000', 2439, '호원사급'),\n    ('65162-L8000', 2439, '호원사급'),\n    ('65158-L1000', 714, '호원사급'),\n    ('65168-L1000', 714, '호원사급'),\n    ('651E4-L1000', 389, '호원사급'),\n    ('651F4-L1000', 389, '호원사급'),\n    ('65176-L1000', 2323, '호원사급'),\n    ('65186-L1000', 2323, '호원사급'),\n    ('65154-L1000', 1210, '호원사급'),\n    ('65164-L1000', 1210, '호원사급'),\n    ('65156-L1000', 1106, '호원사급'),\n    ('65166-L1000', 1106, '호원사급'),\n    ('651E6-L1000', 455, '호원사급'),\n    ('651F6-L1000', 455, '호원사급'),\n    ('65282-L3400', 380, '호원사급'),\n    ('65292-L3400', 380, '호원사급'),\n    ('652E6-L3400', 375, '호원사급'),\n    ('652F6-L3400', 375, '호원사급'),\n    ('65132-L1000', 4644, '호원사급'),\n    ('65132-L2500', 5034, '호원사급'),\n    ('65132-L3400', 5413, '호원사급'),\n    ('65132-L8000', 4946, '호원사급'),\n    ('65132-L8400', 4587, '호원사급'),\n    ('65352-L1000', 499, '호원사급'),\n    ('65362-L1000', 499, '호원사급'),\n    ('65174-L1000', 797, '호원사급'),\n    ('65184-L1000', 797, '호원사급'),\n    ('65264-F6000', 70, '호원사급'),\n    ('65294-D4000', 86, '호원사급'),\n    ('65264-D4000', 86, '호원사급'),\n    ('651E2-L5000', 351, '호원사급'),\n    ('651F2-L5000', 351, '호원사급'),\n    ('65172-L2000', 8937, '호원사급'),\n    ('65182-L2000', 8937, '호원사급'),\n    ('65172-L8000', 10915, '호원사급'),\n    ('65182-L8000', 10915, '호원사급'),\n    ('69145-AT000', 392, '호원사급'),\n    ('69162-G8000', 275, '호원사급'),\n    ('69156-DO000 (PAD)', 1403, '호원사급'),\n    ('69166-DO000 (PAD)', 1403, '호원사급'),\n    ('65996-C5000', 522, '호원사급'),\n    ('99242-06100', 16.25, '호원사급'),\n    ('구조용 접착체', 9700, '호원사급'),\n    ('12904-06101', 17.39, '호원사급'),\n    ('64372-1F000', 14.32, '호원사급'),\n    ('64372-1R000', 19.078, '호원사급'),\n    ('84191-A7500', 38, '호원사급'),\n    ('81763-1Y000', 179.09199999999998, '호원사급'),\n    ('81838-R0600', 320, '호원사급'),\n    ('13905-06000', 11.400000000000002, '호원사급'),\n    ('13905-08000', 20.14, '호원사급'),\n    ('19353-07250', 181.14, '호원사급'),\n    ('10216-10000', 79.5, '호원사급'),\n    ('13917-10120', 49.5, '호원사급'),\n    ('12900-06140', 16.12, '호원사급'),\n    ('12900-06180', 17.89, '호원사급'),\n    ('64372-3V000', 13.05, '호원사급'),\n    ('12922-06201', 35.56, '호원사급'),\n    ('12971-06203', 29.316, '호원사급'),\n    ('65178-L1000', 312.6, '호원사급'),\n    ('65178-L3400', 414.9, '호원사급'),\n    ('69146-AT000', 392, '호원사급'),\n    ('65412-L1000', 828, '대우사급'),\n    ('65422-L1000', 831, '대우사급'),\n    ('65916-L1000', 89, '대우사급'),\n    ('655N6-L1000', 1184, '대우사급'),\n    ('655P6-L1000', 1184, '대우사급'),\n    ('657N2-L1000', 990, '대우사급'),\n    ('657P2-L1000', 949, '대우사급'),\n    ('65832-L1000', 1587, '대우사급'),\n    ('65852-L2000', 3022, '대우사급'),\n    ('65554-D4000', 230, '대우사급'),\n    ('655N6-L8400', 1132, '대우사급'),\n    ('655P6-L8400', 1132, '대우사급'),\n    ('65916-L8400', 123, '대우사급'),\n    ('657A6-E2510', 1064, '풍기사급'),\n    ('657B6-E2510', 1064, '풍기사급'),\n    ('65512-A3000', 4421, '풍기사급'),\n    ('65512-E2510', 4783, '풍기사급'),\n    ('65821-1Y800', 142, '풍기사급'),\n    ('65837-A3000', 1006, '풍기사급'),\n    ('65847-A3000', 857, '풍기사급'),\n    ('65779-1Y010', 57, '풍기사급'),\n    ('65789-1Y010', 57, '풍기사급'),\n    ('65567-E2510', 608, '풍기사급'),\n    ('65598-E2510', 875, '풍기사급'),\n    ('65798-1Y000', 421.3, '풍기사급'),\n    ('64749-CV000', 458.5, '풍기사급'),\n    ('65523-A3500', 258, '풍기사급'),\n    ('50007752', 14.5, '대일씨에프티'),\n    ('50007315', 32, '대일씨에프티'),\n    ('12900-06201', 24, '아신금속'),\n    ('13905-05000', 10.3, '삼진스틸'),\n    ('13194-08220', 101.3, '삼진스틸'),\n    ('13911-08001', 53.6, '삼진스틸'),\n    ('65639-3K000', 151.1, '아신금속'),\n    ('65512-C5000', 7040, ''),\n    ('65512-C5900', 7040, ''),\n    ('65522-L8400', 5513, ''),\n    ('65561-3E001', 12304, ''),\n    ('65630-L2000', 13716, ''),\n    ('65630-L2010', 13432, ''),\n    ('65630-L2020', 12981, ''),\n    ('65630-L2800', 11733, ''),\n    ('65630-L5000', 12388, ''),\n    ('65630-L5010', 12132, ''),\n    ('65630-L8400', 13372, ''),\n    ('65852-L3000', 3050, ''),\n    ('71131-2F510', 30638, ''),\n    ('71141-2F510', 30630, ''),\n    ('71201-07000', 21775, ''),\n    ('71201-3K001', 25631, ''),\n    ('71201-3L001', 25241.05, ''),\n    ('71202-07000', 21775, ''),\n    ('71202-3K001', 25627, ''),\n    ('71202-3L001', 25387.35, ''),\n    ('71377-3R000', 7734, ''),\n    ('71412-3R000', 3877, ''),\n    ('71422-3R000', 3877, ''),\n    ('71601-2G100', 37228, ''),\n    ('71602-2G100', 35639, ''),\n    ('71603-3E000', 34077, ''),\n    ('71603-3E100', 25299.95, ''),\n    ('71604-3E000', 38175, ''),\n    ('71604-3E100', 26712.6, ''),\n    ('71611-3E000', 21473, ''),\n    ('71611-3E100', 20426, ''),\n    ('71621-3E000', 19490, ''),\n    ('71621-3E100', 21604, ''),\n    ('71653-2P000', 2438, ''),\n    ('71663-2P000', 2437, ''),\n    ('71678-2P700', 2956, ''),\n    ('71688-2P700', 2956, ''),\n    ('71731-2P700', 2117, ''),\n    ('71741-2P700', 2103, ''),\n    ('76230-2G010', 20080, ''),\n    ('76231-A7000', 1294, ''),\n    ('76240-2G010', 20022, ''),\n    ('76241-A7000', 1294, ''),\n    ('77230-2G010', 20318, ''),\n    ('77240-2G010', 20314.35, '')\n  ) AS t(item_code, price, supplier)\n)\nSELECT\n  COALESCE(i.item_code, e.item_code) as item_code,\n  i.item_name,\n  i.category,\n  i.price as db_price,\n  e.price as excel_price,\n  e.supplier as excel_supplier,\n  CASE\n    WHEN i.item_code IS NULL THEN 'NOT_IN_DB'\n    WHEN i.price IS NULL THEN 'DB_PRICE_NULL'\n    WHEN ABS(i.price - e.price) < 0.01 THEN 'MATCH'\n    ELSE 'MISMATCH'\n  END as status,\n  ROUND(i.price - e.price, 2) as price_diff\nFROM excel_prices e\nLEFT JOIN items i ON i.item_code = e.item_code AND i.is_active = true\nORDER BY\n  CASE\n    WHEN i.item_code IS NULL THEN 1\n    WHEN i.price IS NULL THEN 2\n    WHEN ABS(i.price - e.price) > 0.01 THEN 3\n    ELSE 4\n  END,\n  item_code;\n"}
