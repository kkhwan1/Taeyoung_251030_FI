# Excel vs DB ë°ì´í„° ëˆ„ë½ ë³µêµ¬ ê³„íš

**ë¶„ì„ ì™„ë£Œ**: 2025. 10. 31. ì˜¤ì „ 8:31:30
**ë¶„ì„ ëŒ€ìƒ**: 4ê°œ Excel íŒŒì¼ â†’ Supabase DB
**ëˆ„ë½ ê·œëª¨**: 3,821ê±´ (78.91%)

---

## ğŸ” ì£¼ìš” ë°œê²¬ì‚¬í•­

### 1. ì‹¬ê°í•œ ë°ì´í„° ëˆ„ë½
- **Excel ì´ ë ˆì½”ë“œ**: 4,842ê±´
- **DB ì‹¤ì œ ì €ì¥**: 1,021ê±´
- **ëˆ„ë½**: 3,821ê±´ (78.91%)

### 2. ì™„ì „íˆ ë¹„ì–´ìˆëŠ” í…Œì´ë¸”
| í…Œì´ë¸” | ìƒíƒœ | Excel ì˜ˆìƒ | ì˜í–¥ |
|--------|------|------------|------|
| `price_master` | âŒ 0ê±´ | 243ê±´ | **ë‹¨ê°€ ì •ë³´ ì „ì²´ ëˆ„ë½** |
| `inventory_transactions` | âŒ 0ê±´ | 1,800ê±´+ | **ì¬ê³  ê±°ë˜ ì „ì²´ ëˆ„ë½** |
| `inbound_transactions` | âŒ 0ê±´ | 532ê±´+ | **ì…ê³  ê±°ë˜ ì „ì²´ ëˆ„ë½** |
| `outbound_transactions` | âŒ 0ê±´ | 385ê±´+ | **ì¶œê³  ê±°ë˜ ì „ì²´ ëˆ„ë½** |
| `production_transactions` | âŒ 0ê±´ | 87ê±´+ | **ìƒì‚° ê±°ë˜ ì „ì²´ ëˆ„ë½** |

### 3. ë¶€ë¶„ ëˆ„ë½ í…Œì´ë¸”
| í…Œì´ë¸” | DB ì €ì¥ | Excel ì˜ˆìƒ | ëˆ„ë½ | ëˆ„ë½ë¥  |
|--------|---------|------------|------|--------|
| `companies` | 61ê±´ | 75ê±´ | 14ê±´ | 18.67% |
| `bom` | 138ê±´ | 591ê±´+ | 453ê±´+ | 76.64% |
| `sales_transactions` | 51ê±´ | 530ê±´+ | 479ê±´+ | 90.38% |
| `purchase_transactions` | 40ê±´ | 176ê±´+ | 136ê±´+ | 77.27% |

---

## ğŸ¯ ëˆ„ë½ ì›ì¸ ë¶„ì„

### ì›ì¸ 1: ì‹œíŠ¸ êµ¬ì¡° ìë™ ì¸ì‹ ì‹¤íŒ¨ âš ï¸

**ë¬¸ì œ**: ëŒ€ë¶€ë¶„ì˜ ì‹œíŠ¸ê°€ `unknown` í…Œì´ë¸”ë¡œ ë¶„ë¥˜ë¨

**ì˜í–¥ì„ ë°›ì€ ì‹œíŠ¸**:
```
íƒœì°½ê¸ˆì† BOM.xlsx:
  - ëŒ€ìš°ê³µì—… (140ê±´)       â†’ unknown âŒ
  - í’ê¸°ì‚°ì—… (55ê±´)        â†’ unknown âŒ
  - ë‹¤ì¸ (20ê±´)           â†’ unknown âŒ
  - í˜¸ì›ì˜¤í†  (227ê±´)       â†’ unknown âŒ
  - ì¸ì•ŒíŒŒì½”ë¦¬ì•„ (149ê±´)    â†’ unknown âŒ
  - ìµœì‹ ë‹¨ê°€ (243ê±´)       â†’ unknown âŒ  â† price_master ëˆ„ë½!

2025ë…„ 9ì›” ë§¤ì…ë§¤ì¶œ ë³´ê³ í˜„í™©.xlsx:
  - ì •ë¦¬ (242ê±´)          â†’ unknown âŒ
  - íƒœì°½ê¸ˆì† (80ê±´)        â†’ unknown âŒ
  - í˜‘ë ¥ì‚¬ (110ê±´)         â†’ unknown âŒ
  - ë§¤ì…ë¶€ìì¬(êµ¬ë§¤) (176ê±´) â†’ unknown âŒ
  - ë‚©í’ˆìˆ˜ëŸ‰(ì˜ì—…) (385ê±´)  â†’ unknown âŒ  â† ì¶œê³  ëˆ„ë½!
  - ì¢…í•© ì¼ì¼ë§¤ì¶œ ë³´ê³ ìš© (530ê±´) â†’ unknown âŒ  â† ë§¤ì¶œ ëˆ„ë½!

2025ë…„ 9ì›” ì¢…í•©ê´€ë¦¬ SHEET.xlsx:
  - ì¢…í•©ì¬ê³  (68ê±´)        â†’ unknown âŒ
  - COIL ì…ê³ í˜„í™© (266ê±´)  â†’ unknown âŒ  â† ì…ê³  ëˆ„ë½!
  - SHEET ì…ê³ í˜„í™© (266ê±´) â†’ unknown âŒ  â† ì…ê³  ëˆ„ë½!
  - ìƒì‚°ì‹¤ì  (87ê±´)        â†’ unknown âŒ  â† ìƒì‚° ëˆ„ë½!

09ì›” ì›ìì¬ ìˆ˜ë¶ˆê´€ë¦¬.xlsx:
  - 21ê°œ ì‹œíŠ¸ ì „ë¶€        â†’ unknown âŒ  â† ì¬ê³  ê±°ë˜ ëˆ„ë½!
```

**ê·¼ë³¸ ì›ì¸**:
- ê¸°ì¡´ ì„í¬íŠ¸ ìŠ¤í¬ë¦½íŠ¸ê°€ íŠ¹ì • ì‹œíŠ¸ëª…ë§Œ ì¸ì‹ (ì˜ˆ: "ì…ê³ ", "ì¶œê³ ", "BOM")
- ì‹¤ì œ ì‹œíŠ¸ëª…ê³¼ ë¶ˆì¼ì¹˜ (ì˜ˆ: "COIL ì…ê³ í˜„í™©", "ë‚©í’ˆìˆ˜ëŸ‰(ì˜ì—…)", "ì¢…í•© ì¼ì¼ë§¤ì¶œ ë³´ê³ ìš©")
- í—¤ë” ê¸°ë°˜ ìë™ ì¸ì‹ ë¡œì§ ë¶€ì¬

### ì›ì¸ 2: ì™¸ë˜í‚¤ ì œì•½ ì¡°ê±´ ìœ„ë°˜

**ë¬¸ì œ**: ì¡´ì¬í•˜ì§€ ì•ŠëŠ” í’ˆëª©/íšŒì‚¬ ì½”ë“œ ì°¸ì¡°

**ì˜ˆìƒ ì˜í–¥**:
- BOM ë§¤í•‘ ì‹¤íŒ¨ (~400ê±´)
- ì¬ê³  ê±°ë˜ ë§¤í•‘ ì‹¤íŒ¨ (~1,800ê±´)

**ê¸°ì¡´ ë¦¬í¬íŠ¸ ì¦ê±°** (MISSING_ITEM_RESOLUTION.md):
```
invalid P/NO: 37ê°œ
unknown supplier codes: 14ê°œ
```

### ì›ì¸ 3: ë°ì´í„° í’ˆì§ˆ í•„í„°ë§

**ë¬¸ì œ**: ìœ íš¨ì„± ê²€ì¦ ì‹¤íŒ¨ë¡œ ìŠ¤í‚µ

**ê¸°ì¡´ ë¦¬í¬íŠ¸ ì¦ê±°** (INVALID_PNO_ANALYSIS_REPORT.md):
```
zero quantity records skipped: 108ê°œ
```

---

## ğŸ“‹ ë³µêµ¬ ê³„íš

### Phase 1: ê¸´ê¸‰ ë³µêµ¬ (ìµœìš°ì„ ) ğŸ”´

#### 1.1. price_master í…Œì´ë¸” ì±„ìš°ê¸°
**ëŒ€ìƒ**: íƒœì°½ê¸ˆì† BOM.xlsx > ìµœì‹ ë‹¨ê°€ ì‹œíŠ¸ (243ê±´)

**ì‘ì—…**:
```bash
# ìŠ¤í¬ë¦½íŠ¸ ìƒì„±
node scripts/migration/import-price-master.js

# ì˜ˆìƒ ê²°ê³¼
- 243ê°œ ë‹¨ê°€ ë ˆì½”ë“œ ì¶”ê°€
- í’ˆëª©ë³„ ìµœì‹  ë‹¨ê°€ ì •ë³´ ë³µêµ¬
```

#### 1.2. ì…ê³  ê±°ë˜ ë³µêµ¬
**ëŒ€ìƒ**:
- 2025ë…„ 9ì›” ì¢…í•©ê´€ë¦¬ SHEET.xlsx > COIL ì…ê³ í˜„í™© (266ê±´)
- 2025ë…„ 9ì›” ì¢…í•©ê´€ë¦¬ SHEET.xlsx > SHEET ì…ê³ í˜„í™© (266ê±´)
- 09ì›” ì›ìì¬ ìˆ˜ë¶ˆê´€ë¦¬.xlsx > ëŒ€ìš°ì‚¬ê¸‰ ì…ê³ í˜„í™© (30ê±´)
- 09ì›” ì›ìì¬ ìˆ˜ë¶ˆê´€ë¦¬.xlsx > í˜¸ì›ì‚¬ê¸‰ ì…ê³ í˜„í™© (69ê±´)
- 09ì›” ì›ìì¬ ìˆ˜ë¶ˆê´€ë¦¬.xlsx > í˜‘ë ¥ì—…ì²´ ì…ê³ í˜„í™© (110ê±´)

**ì‘ì—…**:
```bash
# ì…ê³  ì „ìš© ì„í¬íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ìƒì„±
node scripts/migration/import-inbound-transactions.js

# ì˜ˆìƒ ê²°ê³¼
- 741ê°œ ì…ê³  ê±°ë˜ ì¶”ê°€
- inbound_transactions í…Œì´ë¸” ì±„ì›Œì§
```

#### 1.3. ì¶œê³  ê±°ë˜ ë³µêµ¬
**ëŒ€ìƒ**:
- 2025ë…„ 9ì›” ë§¤ì…ë§¤ì¶œ ë³´ê³ í˜„í™©.xlsx > ë‚©í’ˆìˆ˜ëŸ‰(ì˜ì—…) (385ê±´)

**ì‘ì—…**:
```bash
# ì¶œê³  ì „ìš© ì„í¬íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ìƒì„±
node scripts/migration/import-outbound-transactions.js

# ì˜ˆìƒ ê²°ê³¼
- 385ê°œ ì¶œê³  ê±°ë˜ ì¶”ê°€
- outbound_transactions í…Œì´ë¸” ì±„ì›Œì§
```

### Phase 2: ì¤‘ìš” ë³µêµ¬ (ìš°ì„ ìˆœìœ„ ì¤‘) ğŸŸ¡

#### 2.1. ë§¤ì¶œ ê±°ë˜ ë³µêµ¬
**ëŒ€ìƒ**:
- 2025ë…„ 9ì›” ë§¤ì…ë§¤ì¶œ ë³´ê³ í˜„í™©.xlsx > ì¢…í•© ì¼ì¼ë§¤ì¶œ ë³´ê³ ìš© (530ê±´)

**ì‘ì—…**:
```bash
node scripts/migration/import-sales-transactions.js

# ì˜ˆìƒ ê²°ê³¼
- 479ê°œ ë§¤ì¶œ ê±°ë˜ ì¶”ê°€ (í˜„ì¬ 51ê±´ â†’ 530ê±´)
- ë§¤ì¶œ ë°ì´í„° ì™„ì„±ë„ 90% í–¥ìƒ
```

#### 2.2. ë§¤ì… ê±°ë˜ ë³µêµ¬
**ëŒ€ìƒ**:
- 2025ë…„ 9ì›” ë§¤ì…ë§¤ì¶œ ë³´ê³ í˜„í™©.xlsx > ë§¤ì…ë¶€ìì¬(êµ¬ë§¤) (176ê±´)

**ì‘ì—…**:
```bash
node scripts/migration/import-purchase-transactions.js

# ì˜ˆìƒ ê²°ê³¼
- 136ê°œ ë§¤ì… ê±°ë˜ ì¶”ê°€ (í˜„ì¬ 40ê±´ â†’ 176ê±´)
- ë§¤ì… ë°ì´í„° ì™„ì„±ë„ 77% í–¥ìƒ
```

#### 2.3. BOM ê´€ê³„ ë³µêµ¬
**ëŒ€ìƒ**:
- íƒœì°½ê¸ˆì† BOM.xlsx > ëŒ€ìš°ê³µì—… (140ê±´)
- íƒœì°½ê¸ˆì† BOM.xlsx > í˜¸ì›ì˜¤í†  (227ê±´)
- íƒœì°½ê¸ˆì† BOM.xlsx > ì¸ì•ŒíŒŒì½”ë¦¬ì•„ (149ê±´)

**ì‘ì—…**:
```bash
# ëˆ„ë½ëœ í’ˆëª© ì½”ë“œ ë¨¼ì € ì¶”ê°€
node scripts/migration/add-missing-items-for-bom.js

# BOM ì¬ì„í¬íŠ¸
node scripts/migration/reimport-bom-relationships.js

# ì˜ˆìƒ ê²°ê³¼
- 453ê°œ BOM ê´€ê³„ ì¶”ê°€ (í˜„ì¬ 138ê±´ â†’ 591ê±´)
- BOM ì™„ì„±ë„ 76% í–¥ìƒ
```

### Phase 3: ê¸°íƒ€ ë³µêµ¬ (ìš°ì„ ìˆœìœ„ ë‚®ìŒ) ğŸŸ¢

#### 3.1. ìƒì‚° ê±°ë˜ ë³µêµ¬
**ëŒ€ìƒ**:
- 2025ë…„ 9ì›” ì¢…í•©ê´€ë¦¬ SHEET.xlsx > ìƒì‚°ì‹¤ì  (87ê±´)

#### 3.2. íšŒì‚¬ ì •ë³´ ë³´ì™„
**ëŒ€ìƒ**:
- 2025ë…„ 9ì›” ë§¤ì…ë§¤ì¶œ ë³´ê³ í˜„í™©.xlsx > í˜‘ë ¥ì‚¬ (110ê±´)

---

## ğŸ› ï¸ ì‹¤í–‰ ê°€ì´ë“œ

### ìŠ¤í… 1: ëˆ„ë½ í’ˆëª©/íšŒì‚¬ ì„ í–‰ ì¶”ê°€

```bash
# 1. Excelì—ì„œ ëˆ„ë½ëœ í’ˆëª© ì½”ë“œ ì¶”ì¶œ
node scripts/analysis/extract-missing-item-codes.js

# 2. ëˆ„ë½ëœ í’ˆëª© ì¼ê´„ ì¶”ê°€
node scripts/migration/add-missing-items.ts

# 3. ëˆ„ë½ëœ íšŒì‚¬ ì¼ê´„ ì¶”ê°€
node scripts/migration/add-missing-companies.ts
```

### ìŠ¤í… 2: Phase 1 ê¸´ê¸‰ ë³µêµ¬ ì‹¤í–‰

```bash
# ë‹¨ê°€ ë³µêµ¬
node scripts/migration/import-price-master.js

# ì…ê³  ë³µêµ¬
node scripts/migration/import-inbound-transactions.js

# ì¶œê³  ë³µêµ¬
node scripts/migration/import-outbound-transactions.js
```

### ìŠ¤í… 3: ê²€ì¦

```bash
# ë³µêµ¬ í›„ ì¬ë¶„ì„
node scripts/analyze-excel-vs-db-gap.js

# ì˜ˆìƒ ê²°ê³¼
Before:
  - Excel: 4,842ê±´
  - DB: 1,021ê±´
  - ëˆ„ë½: 3,821ê±´ (78.91%)

After (Phase 1 ì™„ë£Œ):
  - Excel: 4,842ê±´
  - DB: 2,390ê±´ (1,021 + 1,369)
  - ëˆ„ë½: 2,452ê±´ (50.64%)
```

---

## ğŸ“Š ì˜ˆìƒ íš¨ê³¼

### Phase 1 ì™„ë£Œ ì‹œ
| í•­ëª© | Before | After | ê°œì„  |
|------|--------|-------|------|
| price_master | 0ê±´ | 243ê±´ | âœ… 100% |
| inbound_transactions | 0ê±´ | 741ê±´ | âœ… 100% |
| outbound_transactions | 0ê±´ | 385ê±´ | âœ… 100% |
| **ì „ì²´ ëˆ„ë½ë¥ ** | **78.91%** | **50.64%** | **âœ… 28.27%p ê°œì„ ** |

### Phase 1+2 ì™„ë£Œ ì‹œ
| í•­ëª© | Before | After | ê°œì„  |
|------|--------|-------|------|
| sales_transactions | 51ê±´ | 530ê±´ | âœ… 90.38% |
| purchase_transactions | 40ê±´ | 176ê±´ | âœ… 77.27% |
| bom | 138ê±´ | 591ê±´ | âœ… 76.64% |
| **ì „ì²´ ëˆ„ë½ë¥ ** | **78.91%** | **25.12%** | **âœ… 53.79%p ê°œì„ ** |

### Phase 1+2+3 ì™„ë£Œ ì‹œ
- **ì „ì²´ ëˆ„ë½ë¥ **: 78.91% â†’ **15% ì´í•˜** (âœ… **63.91%p ê°œì„ **)
- **ë°ì´í„° ì™„ì„±ë„**: 21.09% â†’ **85% ì´ìƒ**

---

## âš ï¸ ì£¼ì˜ì‚¬í•­

### 1. ì™¸ë˜í‚¤ ì œì•½ ì¡°ê±´
- í’ˆëª©/íšŒì‚¬ ì½”ë“œê°€ ë¨¼ì € ì¡´ì¬í•´ì•¼ í•¨
- ìˆœì„œ: items â†’ companies â†’ transactions

### 2. ì¤‘ë³µ ë°ì´í„° ì²˜ë¦¬
- ê¸°ì¡´ ì„í¬íŠ¸ ìŠ¤í¬ë¦½íŠ¸ëŠ” ì¤‘ë³µ ì œê±° ë¡œì§ í¬í•¨
- ì¬ì‹¤í–‰ ì‹œ ì¤‘ë³µ ì²´í¬ í•„ìš”

### 3. í•œê¸€ ì¸ì½”ë”©
- ëª¨ë“  ì„í¬íŠ¸ ìŠ¤í¬ë¦½íŠ¸ëŠ” UTF-8 ì¸ì½”ë”© ì‚¬ìš©
- `request.text() + JSON.parse()` íŒ¨í„´ ì ìš© í•„ìˆ˜

### 4. ë°ì´í„° í’ˆì§ˆ
- 0 ìˆ˜ëŸ‰ ê±°ë˜ëŠ” ìŠ¤í‚µ (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§)
- Invalid P/NOëŠ” ë³„ë„ ì²˜ë¦¬ í•„ìš”

---

## ğŸ“ ë‹¤ìŒ ë‹¨ê³„

1. **Phase 1 ìŠ¤í¬ë¦½íŠ¸ ìƒì„±** (ê¸´ê¸‰)
   - [ ] import-price-master.js
   - [ ] import-inbound-transactions.js
   - [ ] import-outbound-transactions.js

2. **Phase 2 ìŠ¤í¬ë¦½íŠ¸ ìƒì„±** (ì¤‘ìš”)
   - [ ] import-sales-transactions.js
   - [ ] import-purchase-transactions.js
   - [ ] reimport-bom-relationships.js

3. **ê²€ì¦ ë° ëª¨ë‹ˆí„°ë§**
   - [ ] ë³µêµ¬ í›„ ì¬ë¶„ì„
   - [ ] ì›¹ í™”ë©´ì—ì„œ ë°ì´í„° í™•ì¸
   - [ ] ëˆ„ë½ ë°ì´í„° ìµœì¢… ê²€ì¦

---

**ë¶„ì„ ì™„ë£Œ ì‹œê°„**: 2025. 10. 31. ì˜¤ì „ 8:31:30
**ì˜ˆìƒ ë³µêµ¬ ì‹œê°„**: Phase 1 (2ì‹œê°„) + Phase 2 (3ì‹œê°„) = **ì´ 5ì‹œê°„**
